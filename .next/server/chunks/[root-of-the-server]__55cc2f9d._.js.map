{"version":3,"sources":["turbopack:///[project]/src/server/utils/generate-jwt-cookie.ts","turbopack:///[project]/src/types/api-response.ts","turbopack:///[project]/src/server/prisma-client/index.ts","turbopack:///[project]/node_modules/@prisma/extension-accelerate/dist/index.js","turbopack:///[project]/src/server/utils/handle-response.ts","turbopack:///[project]/src/server/utils/handle-error.ts","turbopack:///[project]/src/server/utils/middleware/compose.ts","turbopack:///[project]/node_modules/cookie/src/index.ts","turbopack:///[project]/src/server/services/user-service.ts","turbopack:///[project]/src/server/utils/omit.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\r\nimport { serialize } from \"cookie\"\r\n\r\nexport const generateJwtToken = (uuid: string) => {\r\n  return jwt.sign(uuid, process.env.JWT_SECRET!)\r\n}\r\n\r\nexport const generateJwtCookie = (uuid: string) => {\r\n  return serialize(\"jwt\", generateJwtToken(uuid), {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    path: \"/\",\r\n    maxAge: 7 * 24 * 60 * 60,\r\n  })\r\n}\r\n\r\nexport const deleteJwtCookie = () => {\r\n  return serialize(\"jwt\", \"\", {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    path: \"/\",\r\n    maxAge: 0,\r\n  })\r\n}\r\n","export type ApiResponse<T> = {\r\n  status: number\r\n  message: string\r\n  data: T\r\n}\r\n\r\nexport type BaseError<T> = {\r\n  status: number\r\n  message: string\r\n  data?: T\r\n}\r\n\r\nexport class ApiError<T> extends Error {\r\n  status: number\r\n  data?: T\r\n\r\n  constructor(response: BaseError<T>) {\r\n    super(response.message || \"An error occurred\")\r\n    this.status = response.status\r\n    this.data = response.data ?? undefined\r\n  }\r\n}\r\n\r\nexport const getApiError = <T = unknown>(e: unknown): ApiError<T> => {\r\n  if (typeof e === \"object\" && e !== null && \"status\" in e && \"message\" in e) {\r\n    const errObj = e as { status: number; message: string; data?: T }\r\n    return new ApiError<T>({\r\n      status: Number(errObj.status) || 500,\r\n      message: errObj.message,\r\n      data: errObj.data,\r\n    })\r\n  }\r\n\r\n  const safeError = (msg: string) =>\r\n    new ApiError<T>({ status: 500, message: msg, data: undefined })\r\n\r\n  const isObjectWithData = (obj: unknown): obj is { data: unknown } =>\r\n    typeof obj === \"object\" && obj !== null && \"data\" in obj\r\n\r\n  if (!isObjectWithData(e)) {\r\n    return safeError(\r\n      e instanceof Error ? e.message : \"Произошла неизвестная ошибка\",\r\n    )\r\n  }\r\n\r\n  if (!isObjectWithData(e.data)) {\r\n    return safeError(\r\n      e.data instanceof Error ? e.data.message : \"Произошла неизвестная ошибка\",\r\n    )\r\n  }\r\n\r\n  const errObj = e.data as {\r\n    status: number | string\r\n    data?: T\r\n    error?: string\r\n  }\r\n\r\n  return new ApiError<T>({\r\n    status: Number(errObj.status) || 500,\r\n    message: errObj.error || \"Ошибка запроса\",\r\n    data: errObj.data ?? undefined,\r\n  })\r\n}\r\n","import { PrismaClient } from \"@prisma/client\"\r\nimport { withAccelerate } from \"@prisma/extension-accelerate\"\r\n\r\nexport const prisma = new PrismaClient().$extends(withAccelerate())\r\n","import l from\"@prisma/client/scripts/default-index.js\";function f(a,n){let[c=0,u=0,m=0]=a.split(\".\").map(Number),[o=0,h=0,i=0]=n.split(\".\").map(Number),r=o-c,e=h-u,t=i-m;return r||e||t}import w from\"@prisma/client/scripts/default-index.js\";function p(){let a=w.Prisma.prismaVersion;return[F(),`PrismaEngine/${a.engine}`,`PrismaClient/${a.client}`].join(\" \")}function F(){return typeof navigator<\"u\"?navigator.userAgent:typeof process<\"u\"&&typeof process.versions<\"u\"?`Node/${process.versions.node} (${process.platform}; ${process.arch})`:\"EdgeRuntime\"in globalThis?\"Vercel-Edge-Runtime\":\"UnknownRuntime\"}var P=\"@prisma/extension-accelerate\",x=\"Unable to connect to the Accelerate API. This may be due to a network or DNS issue. Please check your connection and the Accelerate connection string. For details, visit https://www.prisma.io/docs/accelerate/troubleshoot.\";function b(a){let n=p(),c;return async u=>{let{args:m}=u,{cacheStrategy:o,__accelerateInfo:h=!1,...i}=m,r=null,{__internalParams:e,query:t}=u;return e.customDataProxyFetch=()=>async(s,d)=>{let A=new Array;typeof o?.ttl==\"number\"&&A.push(`max-age=${o.ttl}`),typeof o?.swr==\"number\"&&A.push(`stale-while-revalidate=${o.swr}`);let y=o?.tags?.join(\",\")??\"\";d.headers={...d.headers,\"cache-control\":A.length>0?A.join(\",\"):\"no-cache\",\"user-agent\":n,...y.length>0?{\"accelerate-cache-tags\":y}:{}},c&&(d.headers[\"accelerate-query-engine-jwt\"]=c);try{let g=await a(s,d);return r={cacheStatus:g.headers.get(\"accelerate-cache-status\"),lastModified:new Date(g.headers.get(\"last-modified\")??\"\"),region:g.headers.get(\"cf-ray\")?.split(\"-\")[1]??\"unspecified\",requestId:g.headers.get(\"cf-ray\")??\"unspecified\",signature:g.headers.get(\"accelerate-signature\")??\"unspecified\"},c=g.headers.get(\"accelerate-query-engine-jwt\")??void 0,g}catch{throw new Error(x)}},h?{data:await t(i,e),info:r}:t(i,e)}}function T(a){let n=f(\"5.1.0\",l.Prisma.prismaVersion.client)>=0;return l.Prisma.defineExtension(c=>{let{apiKeyPromise:u,baseURL:m}=S(c),o=b(a);async function h(r){let e=await u;if(!e)return{requestId:\"unspecified\"};let t;try{t=await a(new URL(\"/invalidate\",m).href,{method:\"POST\",headers:{authorization:`Bearer ${e}`,\"content-type\":\"application/json\"},body:JSON.stringify(r)})}catch{throw new Error(x)}if(!t?.ok){let s=await t.text();throw new Error(`Failed to invalidate Accelerate cache. Response was ${t.status} ${t.statusText}. ${s}`)}return t.body?.cancel(),{requestId:t.headers.get(\"cf-ray\")??\"unspecified\"}}let i=c.$extends({name:P,query:{$allModels:{$allOperations:o}}});return i.$extends({name:P,client:{$accelerate:{invalidate:r=>h(r),invalidateAll:()=>h({tags:\"all\"})}},model:{$allModels:{aggregate(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.aggregate(r);return Object.assign(s,{withAccelerateInfo(){return t.aggregate({...r,__accelerateInfo:!0})}})},count(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.count(r);return Object.assign(s,{withAccelerateInfo(){return t.count({...r,__accelerateInfo:!0})}})},findFirst(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.findFirst(r);return Object.assign(s,{withAccelerateInfo(){return t.findFirst({...r,__accelerateInfo:!0})}})},findFirstOrThrow(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.findFirstOrThrow(r);return Object.assign(s,{withAccelerateInfo(){return t.findFirstOrThrow({...r,__accelerateInfo:!0})}})},findMany(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.findMany(r);return Object.assign(s,{withAccelerateInfo(){return t.findMany({...r,__accelerateInfo:!0})}})},findUnique(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.findUnique(r);return Object.assign(s,{withAccelerateInfo(){return t.findUnique({...r,__accelerateInfo:!0})}})},findUniqueOrThrow(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.findUniqueOrThrow(r);return Object.assign(s,{withAccelerateInfo(){return t.findUniqueOrThrow({...r,__accelerateInfo:!0})}})},groupBy(r){let e=l.Prisma.getExtensionContext(this),t=n?e.$parent[e.$name]:i[e.name],s=t.groupBy(r);return Object.assign(s,{withAccelerateInfo(){return t.groupBy({...r,__accelerateInfo:!0})}})}}}})})}function S(a){let n=Reflect.get(a,\"_accelerateEngineConfig\");try{let{host:c,hostname:u,protocol:m,searchParams:o}=new URL(n?.accelerateUtils?.resolveDatasourceUrl?.(n));if(m===\"prisma+postgres:\"&&(u===\"localhost\"||u===\"127.0.0.1\"))return{apiKeyPromise:Promise.resolve(o.get(\"api_key\")),baseURL:new URL(`http://${c}`)}}catch{}return{apiKeyPromise:a._engine.start().then(()=>a._engine.apiKey?.()??null),baseURL:new URL(\"https://accelerate.prisma-data.net\")}}function k(a){let n=a?.fetch??fetch;return T(n)}export{x as FETCH_FAILURE_MESSAGE,T as makeAccelerateExtension,k as withAccelerate};\n","import { NextResponse } from \"next/server\"\r\n\r\nexport const handleResponse = (\r\n  message: string,\r\n  status: number,\r\n  data?: unknown,\r\n  headers?: {\r\n    \"Set-Cookie\": string\r\n    \"Content-Type\": \"application/json\"\r\n  },\r\n) => {\r\n  return NextResponse.json(\r\n    {\r\n      status,\r\n      message,\r\n      data,\r\n    },\r\n    { status, headers },\r\n  )\r\n}\r\n","import { ApiError, getApiError } from \"@/types/api-response\"\r\nimport { handleResponse } from \"@/server/utils/handle-response\"\r\nimport { ZodError } from \"zod\"\r\n\r\nexport const handleError = (error: unknown) => {\r\n  if (error instanceof ApiError) {\r\n    return handleResponse(error.message, error.status, error.data)\r\n  }\r\n\r\n  if (\r\n    error &&\r\n    typeof error === \"object\" &&\r\n    \"issues\" in error &&\r\n    Array.isArray(error.issues)\r\n  ) {\r\n    const zodError = error as ZodError\r\n    const messages = zodError.issues.map((e) => e.message)\r\n    return handleResponse(messages.join(\"; \"), 400)\r\n  }\r\n\r\n  const apiError = getApiError(error)\r\n  return handleResponse(apiError.message, apiError.status, apiError.data)\r\n}\r\n","import { handleError } from \"@/server/utils/handle-error\"\r\nimport { prisma } from \"@/server/prisma-client\"\r\nimport { UserRole } from \"@prisma/client\"\r\n\r\nexport interface Context {\r\n  request: Request\r\n  body?: unknown\r\n  userUuid?: string\r\n  params?: Record<string, string>\r\n  queryParams?: Record<string, string>\r\n}\r\n\r\nexport type Handler = (ctx: Context) => Promise<Response>\r\nexport type Middleware = (next: Handler) => Handler\r\n\r\nexport const compose = (\r\n  middlewares: Middleware[],\r\n  finalHandler: Handler,\r\n): Handler =>\r\n  middlewares.reduceRight<Handler>((next, mw) => mw(next), finalHandler)\r\n\r\nexport const createRoute = (\r\n  middlewares: Middleware[],\r\n  finalHandler: Handler,\r\n) => {\r\n  const pipeline = compose(middlewares, finalHandler)\r\n  return async (\r\n    request: Request,\r\n    context?: {\r\n      params?: Record<string, string> | Promise<Record<string, string>>\r\n    },\r\n  ) => {\r\n    const maybeParams = context?.params as\r\n      | Record<string, string>\r\n      | Promise<Record<string, string>>\r\n      | undefined\r\n\r\n    const params =\r\n      maybeParams &&\r\n      typeof (maybeParams as Promise<Record<string, string>>).then ===\r\n        \"function\"\r\n        ? await (maybeParams as Promise<Record<string, string>>)\r\n        : (maybeParams as Record<string, string> | undefined)\r\n\r\n    const url = new URL(request.url)\r\n    const queryParams = Object.fromEntries(url.searchParams.entries())\r\n\r\n    return pipeline({ request, params, queryParams })\r\n  }\r\n}\r\n\r\nexport const errorBoundary = (): Middleware => (next) => async (ctx) => {\r\n  try {\r\n    return await next(ctx)\r\n  } catch (error) {\r\n    return handleError(error)\r\n  }\r\n}\r\n\r\nexport function jsonBody<T = unknown>(): Middleware {\r\n  return (next) => async (ctx) => {\r\n    try {\r\n      const body = (await ctx.request.json()) as T\r\n      return next({ ...ctx, body })\r\n    } catch {\r\n      return handleError({ status: 400, message: \"Invalid JSON body\" })\r\n    }\r\n  }\r\n}\r\n\r\nexport const auth = (): Middleware => (next) => async (ctx) => {\r\n  const cookieHeader = ctx.request.headers.get(\"cookie\") || \"\"\r\n  const { parse } = await import(\"cookie\")\r\n  const jwtModule = await import(\"jsonwebtoken\")\r\n  const cookies = parse(cookieHeader)\r\n  const token = cookies.jwt\r\n\r\n  if (!token) {\r\n    return handleError({ status: 401, message: \"Не авторизован\" })\r\n  }\r\n\r\n  try {\r\n    const payload = jwtModule.default.verify(\r\n      token,\r\n      process.env.JWT_SECRET!,\r\n    ) as string\r\n    return next({ ...ctx, userUuid: payload })\r\n  } catch {\r\n    return handleError({ status: 401, message: \"Неверный токен\" })\r\n  }\r\n}\r\n\r\nexport const requireRole =\r\n  (role: UserRole | UserRole[]): Middleware =>\r\n  (next) =>\r\n  async (ctx) => {\r\n    const roles = Array.isArray(role) ? role : [role]\r\n\r\n    const user = await prisma.user.findFirst({\r\n      where: {\r\n        uuid: ctx.userUuid,\r\n      },\r\n    })\r\n\r\n    if (!user) {\r\n      return handleError({ status: 401, message: \"Не авторизован\" })\r\n    }\r\n\r\n    if (!roles.includes(user.role)) {\r\n      return handleError({ status: 403, message: \"Нет доступа\" })\r\n    }\r\n\r\n    return next(ctx)\r\n  }\r\n","/**\n * RegExp to match cookie-name in RFC 6265 sec 4.1.1\n * This refers out to the obsoleted definition of token in RFC 2616 sec 2.2\n * which has been replaced by the token definition in RFC 7230 appendix B.\n *\n * cookie-name       = token\n * token             = 1*tchar\n * tchar             = \"!\" / \"#\" / \"$\" / \"%\" / \"&\" / \"'\" /\n *                     \"*\" / \"+\" / \"-\" / \".\" / \"^\" / \"_\" /\n *                     \"`\" / \"|\" / \"~\" / DIGIT / ALPHA\n *\n * Note: Allowing more characters - https://github.com/jshttp/cookie/issues/191\n * Allow same range as cookie value, except `=`, which delimits end of name.\n */\nconst cookieNameRegExp = /^[\\u0021-\\u003A\\u003C\\u003E-\\u007E]+$/;\n\n/**\n * RegExp to match cookie-value in RFC 6265 sec 4.1.1\n *\n * cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )\n * cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E\n *                     ; US-ASCII characters excluding CTLs,\n *                     ; whitespace DQUOTE, comma, semicolon,\n *                     ; and backslash\n *\n * Allowing more characters: https://github.com/jshttp/cookie/issues/191\n * Comma, backslash, and DQUOTE are not part of the parsing algorithm.\n */\nconst cookieValueRegExp = /^[\\u0021-\\u003A\\u003C-\\u007E]*$/;\n\n/**\n * RegExp to match domain-value in RFC 6265 sec 4.1.1\n *\n * domain-value      = <subdomain>\n *                     ; defined in [RFC1034], Section 3.5, as\n *                     ; enhanced by [RFC1123], Section 2.1\n * <subdomain>       = <label> | <subdomain> \".\" <label>\n * <label>           = <let-dig> [ [ <ldh-str> ] <let-dig> ]\n *                     Labels must be 63 characters or less.\n *                     'let-dig' not 'letter' in the first char, per RFC1123\n * <ldh-str>         = <let-dig-hyp> | <let-dig-hyp> <ldh-str>\n * <let-dig-hyp>     = <let-dig> | \"-\"\n * <let-dig>         = <letter> | <digit>\n * <letter>          = any one of the 52 alphabetic characters A through Z in\n *                     upper case and a through z in lower case\n * <digit>           = any one of the ten digits 0 through 9\n *\n * Keep support for leading dot: https://github.com/jshttp/cookie/issues/173\n *\n * > (Note that a leading %x2E (\".\"), if present, is ignored even though that\n * character is not permitted, but a trailing %x2E (\".\"), if present, will\n * cause the user agent to ignore the attribute.)\n */\nconst domainValueRegExp =\n  /^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i;\n\n/**\n * RegExp to match path-value in RFC 6265 sec 4.1.1\n *\n * path-value        = <any CHAR except CTLs or \";\">\n * CHAR              = %x01-7F\n *                     ; defined in RFC 5234 appendix B.1\n */\nconst pathValueRegExp = /^[\\u0020-\\u003A\\u003D-\\u007E]*$/;\n\nconst __toString = Object.prototype.toString;\n\nconst NullObject = /* @__PURE__ */ (() => {\n  const C = function () {};\n  C.prototype = Object.create(null);\n  return C;\n})() as unknown as { new (): any };\n\n/**\n * Parse options.\n */\nexport interface ParseOptions {\n  /**\n   * Specifies a function that will be used to decode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since the value of a cookie has a limited character set (and must be a simple string), this function can be used to decode\n   * a previously-encoded cookie value into a JavaScript string.\n   *\n   * The default function is the global `decodeURIComponent`, wrapped in a `try..catch`. If an error\n   * is thrown it will return the cookie's original value. If you provide your own encode/decode\n   * scheme you must ensure errors are appropriately handled.\n   *\n   * @default decode\n   */\n  decode?: (str: string) => string | undefined;\n}\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n */\nexport function parse(\n  str: string,\n  options?: ParseOptions,\n): Record<string, string | undefined> {\n  const obj: Record<string, string | undefined> = new NullObject();\n  const len = str.length;\n  // RFC 6265 sec 4.1.1, RFC 2616 2.2 defines a cookie name consists of one char minimum, plus '='.\n  if (len < 2) return obj;\n\n  const dec = options?.decode || decode;\n  let index = 0;\n\n  do {\n    const eqIdx = str.indexOf(\"=\", index);\n    if (eqIdx === -1) break; // No more cookie pairs.\n\n    const colonIdx = str.indexOf(\";\", index);\n    const endIdx = colonIdx === -1 ? len : colonIdx;\n\n    if (eqIdx > endIdx) {\n      // backtrack on prior semicolon\n      index = str.lastIndexOf(\";\", eqIdx - 1) + 1;\n      continue;\n    }\n\n    const keyStartIdx = startIndex(str, index, eqIdx);\n    const keyEndIdx = endIndex(str, eqIdx, keyStartIdx);\n    const key = str.slice(keyStartIdx, keyEndIdx);\n\n    // only assign once\n    if (obj[key] === undefined) {\n      let valStartIdx = startIndex(str, eqIdx + 1, endIdx);\n      let valEndIdx = endIndex(str, endIdx, valStartIdx);\n\n      const value = dec(str.slice(valStartIdx, valEndIdx));\n      obj[key] = value;\n    }\n\n    index = endIdx + 1;\n  } while (index < len);\n\n  return obj;\n}\n\nfunction startIndex(str: string, index: number, max: number) {\n  do {\n    const code = str.charCodeAt(index);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) return index;\n  } while (++index < max);\n  return max;\n}\n\nfunction endIndex(str: string, index: number, min: number) {\n  while (index > min) {\n    const code = str.charCodeAt(--index);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) return index + 1;\n  }\n  return min;\n}\n\n/**\n * Serialize options.\n */\nexport interface SerializeOptions {\n  /**\n   * Specifies a function that will be used to encode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since value of a cookie has a limited character set (and must be a simple string), this function can be used to encode\n   * a value into a string suited for a cookie's value, and should mirror `decode` when parsing.\n   *\n   * @default encodeURIComponent\n   */\n  encode?: (str: string) => string;\n  /**\n   * Specifies the `number` (in seconds) to be the value for the [`Max-Age` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.2).\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  maxAge?: number;\n  /**\n   * Specifies the `Date` object to be the value for the [`Expires` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.1).\n   * When no expiration is set clients consider this a \"non-persistent cookie\" and delete it the current session is over.\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  expires?: Date;\n  /**\n   * Specifies the value for the [`Domain` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.3).\n   * When no domain is set clients consider the cookie to apply to the current domain only.\n   */\n  domain?: string;\n  /**\n   * Specifies the value for the [`Path` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.4).\n   * When no path is set, the path is considered the [\"default path\"](https://tools.ietf.org/html/rfc6265#section-5.1.4).\n   */\n  path?: string;\n  /**\n   * Enables the [`HttpOnly` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.6).\n   * When enabled, clients will not allow client-side JavaScript to see the cookie in `document.cookie`.\n   */\n  httpOnly?: boolean;\n  /**\n   * Enables the [`Secure` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.5).\n   * When enabled, clients will only send the cookie back if the browser has a HTTPS connection.\n   */\n  secure?: boolean;\n  /**\n   * Enables the [`Partitioned` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-cutler-httpbis-partitioned-cookies/).\n   * When enabled, clients will only send the cookie back when the current domain _and_ top-level domain matches.\n   *\n   * This is an attribute that has not yet been fully standardized, and may change in the future.\n   * This also means clients may ignore this attribute until they understand it. More information\n   * about can be found in [the proposal](https://github.com/privacycg/CHIPS).\n   */\n  partitioned?: boolean;\n  /**\n   * Specifies the value for the [`Priority` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   *\n   * - `'low'` will set the `Priority` attribute to `Low`.\n   * - `'medium'` will set the `Priority` attribute to `Medium`, the default priority when not set.\n   * - `'high'` will set the `Priority` attribute to `High`.\n   *\n   * More information about priority levels can be found in [the specification](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   */\n  priority?: \"low\" | \"medium\" | \"high\";\n  /**\n   * Specifies the value for the [`SameSite` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   *\n   * - `true` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   * - `'lax'` will set the `SameSite` attribute to `Lax` for lax same site enforcement.\n   * - `'none'` will set the `SameSite` attribute to `None` for an explicit cross-site cookie.\n   * - `'strict'` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   *\n   * More information about enforcement levels can be found in [the specification](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   */\n  sameSite?: boolean | \"lax\" | \"strict\" | \"none\";\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize a name value pair into a cookie string suitable for\n * http headers. An optional options object specifies cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n */\nexport function serialize(\n  name: string,\n  val: string,\n  options?: SerializeOptions,\n): string {\n  const enc = options?.encode || encodeURIComponent;\n\n  if (!cookieNameRegExp.test(name)) {\n    throw new TypeError(`argument name is invalid: ${name}`);\n  }\n\n  const value = enc(val);\n\n  if (!cookieValueRegExp.test(value)) {\n    throw new TypeError(`argument val is invalid: ${val}`);\n  }\n\n  let str = name + \"=\" + value;\n  if (!options) return str;\n\n  if (options.maxAge !== undefined) {\n    if (!Number.isInteger(options.maxAge)) {\n      throw new TypeError(`option maxAge is invalid: ${options.maxAge}`);\n    }\n\n    str += \"; Max-Age=\" + options.maxAge;\n  }\n\n  if (options.domain) {\n    if (!domainValueRegExp.test(options.domain)) {\n      throw new TypeError(`option domain is invalid: ${options.domain}`);\n    }\n\n    str += \"; Domain=\" + options.domain;\n  }\n\n  if (options.path) {\n    if (!pathValueRegExp.test(options.path)) {\n      throw new TypeError(`option path is invalid: ${options.path}`);\n    }\n\n    str += \"; Path=\" + options.path;\n  }\n\n  if (options.expires) {\n    if (\n      !isDate(options.expires) ||\n      !Number.isFinite(options.expires.valueOf())\n    ) {\n      throw new TypeError(`option expires is invalid: ${options.expires}`);\n    }\n\n    str += \"; Expires=\" + options.expires.toUTCString();\n  }\n\n  if (options.httpOnly) {\n    str += \"; HttpOnly\";\n  }\n\n  if (options.secure) {\n    str += \"; Secure\";\n  }\n\n  if (options.partitioned) {\n    str += \"; Partitioned\";\n  }\n\n  if (options.priority) {\n    const priority =\n      typeof options.priority === \"string\"\n        ? options.priority.toLowerCase()\n        : undefined;\n    switch (priority) {\n      case \"low\":\n        str += \"; Priority=Low\";\n        break;\n      case \"medium\":\n        str += \"; Priority=Medium\";\n        break;\n      case \"high\":\n        str += \"; Priority=High\";\n        break;\n      default:\n        throw new TypeError(`option priority is invalid: ${options.priority}`);\n    }\n  }\n\n  if (options.sameSite) {\n    const sameSite =\n      typeof options.sameSite === \"string\"\n        ? options.sameSite.toLowerCase()\n        : options.sameSite;\n    switch (sameSite) {\n      case true:\n      case \"strict\":\n        str += \"; SameSite=Strict\";\n        break;\n      case \"lax\":\n        str += \"; SameSite=Lax\";\n        break;\n      case \"none\":\n        str += \"; SameSite=None\";\n        break;\n      default:\n        throw new TypeError(`option sameSite is invalid: ${options.sameSite}`);\n    }\n  }\n\n  return str;\n}\n\n/**\n * URL-decode string value. Optimized to skip native call when no %.\n */\nfunction decode(str: string): string {\n  if (str.indexOf(\"%\") === -1) return str;\n\n  try {\n    return decodeURIComponent(str);\n  } catch (e) {\n    return str;\n  }\n}\n\n/**\n * Determine if value is a Date.\n */\nfunction isDate(val: any): val is Date {\n  return __toString.call(val) === \"[object Date]\";\n}\n","import bcrypt from \"bcrypt\"\r\nimport { Language, Prisma, User, UserRole } from \"@prisma/client\"\r\nimport { ApiError } from \"@/types/api-response\"\r\nimport { UserDTO } from \"@/types/dto/user\"\r\nimport z from \"zod\"\r\nimport { prisma } from \"@/server/prisma-client\"\r\nimport { omit } from \"@/server/utils/omit\"\r\nimport { Pagination } from \"@/types/dto/pagination\"\r\nimport { NextResponse } from \"next/server\"\r\nimport { generateJwtToken } from \"@/server/utils/generate-jwt-cookie\"\r\n\r\nconst signUpUserSchema = z.object({\r\n  firstName: z.string().min(1, \"Имя обязательно\"),\r\n  lastName: z.string().min(1, \"Фамилия обязательна\"),\r\n  email: z\r\n    .string()\r\n    .min(1, \"Email обязателен\")\r\n    .refine((val) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(val), {\r\n      message: \"Некорректный email адрес\",\r\n    }),\r\n  password: z\r\n    .string()\r\n    .min(8, \"Пароль слишком короткий\")\r\n    .max(64, \"Пароль слишком длинный\"),\r\n})\r\n\r\nexport type SignUpRequestBody = z.infer<typeof signUpUserSchema>\r\n\r\nexport const signUpUser = async (body: SignUpRequestBody): Promise<UserDTO> => {\r\n  signUpUserSchema.parse(body)\r\n\r\n  const hashedPassword = await bcrypt.hash(body.password, 12)\r\n\r\n  try {\r\n    return prisma.user.create({\r\n      data: {\r\n        email: body.email,\r\n        firstName: body.firstName,\r\n        lastName: body.lastName,\r\n        password: hashedPassword,\r\n      },\r\n      omit: {\r\n        password: true,\r\n      },\r\n    })\r\n  } catch (e) {\r\n    if (\r\n      e instanceof Prisma.PrismaClientKnownRequestError &&\r\n      e.code === \"P2002\"\r\n    ) {\r\n      throw new ApiError({\r\n        status: 400,\r\n        message: \"Пользователь с таким email уже есть\",\r\n      })\r\n    }\r\n    throw new ApiError({\r\n      status: 500,\r\n      message: \"Неизвестная ошибка\",\r\n    })\r\n  }\r\n}\r\n\r\nconst signInUserSchema = z.object({\r\n  email: z\r\n    .string()\r\n    .min(1, \"Email обязателен\")\r\n    .refine((val) => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(val), {\r\n      message: \"Некорректный email адрес\",\r\n    }),\r\n  password: z\r\n    .string()\r\n    .min(8, \"Пароль слишком короткий\")\r\n    .max(64, \"Пароль слишком длинный\"),\r\n})\r\n\r\nexport type SignInUserRequestBody = z.infer<typeof signInUserSchema>\r\n\r\nexport const signInUser = async (\r\n  body: SignInUserRequestBody,\r\n): Promise<UserDTO> => {\r\n  signInUserSchema.parse(body)\r\n\r\n  const user: User | null = await prisma.user.findFirst({\r\n    where: {\r\n      email: body.email,\r\n    },\r\n  })\r\n\r\n  if (!user) {\r\n    throw new ApiError({ status: 400, message: \"Неверный email или пароль\" })\r\n  }\r\n\r\n  const isPasswordValid = await bcrypt.compare(body.password, user.password)\r\n\r\n  if (!isPasswordValid) {\r\n    throw new ApiError({ status: 400, message: \"Неверный email или пароль\" })\r\n  }\r\n\r\n  return omit(user, [\"password\"])\r\n}\r\n\r\nexport const getMe = async (uuid: string): Promise<UserDTO> => {\r\n  const user: UserDTO | null = await prisma.user.findFirst({\r\n    where: {\r\n      uuid,\r\n    },\r\n    omit: {\r\n      password: true,\r\n    },\r\n  })\r\n\r\n  if (!user) {\r\n    throw new ApiError({ status: 401, message: \"Не авторизован\" })\r\n  }\r\n\r\n  return user\r\n}\r\n\r\nexport const updateLanguageSchema = z.object({\r\n  language: z.enum(Language),\r\n})\r\n\r\nexport type UpdateLanguageRequestBody = z.infer<typeof updateLanguageSchema>\r\n\r\nexport const updateLanguage = async (\r\n  body: UpdateLanguageRequestBody,\r\n  uuid?: string,\r\n) => {\r\n  updateLanguageSchema.parse(body)\r\n\r\n  const user: UserDTO = await prisma.user.update({\r\n    where: { uuid },\r\n    data: {\r\n      language: body.language,\r\n    },\r\n    omit: { password: true },\r\n  })\r\n\r\n  return user\r\n}\r\n\r\nconst updateUserProfileSchema = z.object({\r\n  firstName: z.string(),\r\n  lastName: z.string(),\r\n})\r\n\r\nexport type UpdateUserProfileRequestBody = z.infer<\r\n  typeof updateUserProfileSchema\r\n>\r\n\r\nexport const updateUser = async (\r\n  uuid: string,\r\n  body: UpdateUserProfileRequestBody,\r\n) => {\r\n  updateUserProfileSchema.parse(body)\r\n\r\n  return prisma.user.update({\r\n    where: {\r\n      uuid,\r\n    },\r\n    data: {\r\n      ...body,\r\n    },\r\n  })\r\n}\r\n\r\nexport type GetUsersQueryParams = {\r\n  offset?: number\r\n  limit?: number\r\n  search?: string\r\n}\r\n\r\ntype GetUsers = (\r\n  queryParams: GetUsersQueryParams,\r\n) => Promise<Pagination<UserDTO[]>>\r\n\r\nexport const getUsersQueryOptions = (\r\n  queryParams: GetUsersQueryParams,\r\n): Prisma.UserFindManyArgs => {\r\n  const search = queryParams.search || \"\"\r\n  return {\r\n    where: {\r\n      OR: [\r\n        {\r\n          email: {\r\n            contains: search,\r\n          },\r\n        },\r\n        {\r\n          firstName: {\r\n            contains: search,\r\n          },\r\n        },\r\n        {\r\n          lastName: {\r\n            contains: search,\r\n          },\r\n        },\r\n      ],\r\n    },\r\n    take: queryParams.limit || 10,\r\n    skip: queryParams.offset || 0,\r\n    orderBy: {\r\n      createdAt: \"asc\",\r\n    },\r\n  }\r\n}\r\n\r\nexport const getUsers: GetUsers = async (queryParams) => {\r\n  const search = queryParams.search || \"\"\r\n\r\n  return {\r\n    data: await prisma.user.findMany(getUsersQueryOptions(queryParams)),\r\n    limit: queryParams.limit || 10,\r\n    offset: queryParams.offset || 0,\r\n    total: await prisma.user.count({\r\n      where: {\r\n        OR: [\r\n          {\r\n            email: {\r\n              contains: search,\r\n            },\r\n          },\r\n          {\r\n            firstName: {\r\n              contains: search,\r\n            },\r\n          },\r\n          {\r\n            lastName: {\r\n              contains: search,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    }),\r\n  }\r\n}\r\n\r\nexport const deleteUser = (uuid: string) =>\r\n  prisma.user.delete({\r\n    where: {\r\n      uuid,\r\n    },\r\n  })\r\n\r\nconst updateUserSchema = z.object({\r\n  firstName: z.string(),\r\n  lastName: z.string(),\r\n  email: z.string(),\r\n  role: z.enum(UserRole),\r\n  language: z.enum(Language),\r\n  locationUuid: z.string(),\r\n})\r\n\r\nexport type UpdateUserRequestBody = z.infer<typeof updateUserSchema>\r\n\r\nexport const updateUserAdmin = async (\r\n  uuid: string,\r\n  body: UpdateUserRequestBody,\r\n) => {\r\n  updateUserSchema.parse(body)\r\n\r\n  return prisma.user.update({\r\n    where: {\r\n      uuid,\r\n    },\r\n    data: {\r\n      ...body,\r\n    },\r\n  })\r\n}\r\n\r\nexport const googleAuth = async (code: string, url: string) => {\r\n  const GOOGLE_TOKEN_URL = \"https://oauth2.googleapis.com/token\"\r\n  const GOOGLE_USERINFO_URL = \"https://www.googleapis.com/oauth2/v3/userinfo\"\r\n\r\n  const clientId = process.env.GOOGLE_CLIENT_ID!\r\n  const clientSecret = process.env.GOOGLE_CLIENT_SECRET!\r\n  const redirectUri = `${process.env.NEXT_PUBLIC_API_URL}/user/google/callback`\r\n\r\n  const tokenResponse = await fetch(GOOGLE_TOKEN_URL, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/x-www-form-urlencoded\" },\r\n    body: new URLSearchParams({\r\n      code,\r\n      client_id: clientId,\r\n      client_secret: clientSecret,\r\n      redirect_uri: redirectUri,\r\n      grant_type: \"authorization_code\",\r\n    }),\r\n  })\r\n\r\n  const tokenData = await tokenResponse.json()\r\n\r\n  console.log(\"response\", tokenData)\r\n\r\n  if (!tokenData.access_token) {\r\n    console.error(\"Token exchange failed\", tokenData)\r\n  }\r\n\r\n  const userResponse = await fetch(GOOGLE_USERINFO_URL, {\r\n    headers: { Authorization: `Bearer ${tokenData.access_token}` },\r\n  })\r\n\r\n  const user = await userResponse.json()\r\n\r\n  console.log(\"userdata\", user)\r\n\r\n  const signupUserRequestBody = {\r\n    firstName: user.given_name,\r\n    lastName: user.family_name,\r\n    email: user.email,\r\n    password: \"google_oauth2_password\",\r\n  }\r\n\r\n  let existingUser\r\n  try {\r\n    existingUser = await prisma.user.findFirst({\r\n      where: {\r\n        email: user.email,\r\n      },\r\n    })\r\n  } catch {\r\n    existingUser = null\r\n  }\r\n\r\n  console.log(\"existingUser\", existingUser)\r\n  console.log(\"url\", new URL(\"/\", url))\r\n\r\n  if (existingUser) {\r\n    const response = NextResponse.redirect(\r\n      new URL(\"/\", process.env.NEXT_PUBLIC_HOME_URL),\r\n    )\r\n\r\n    response.cookies.set(\"jwt\", generateJwtToken(existingUser.uuid), {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      sameSite: \"lax\",\r\n      maxAge: 60 * 60 * 24 * 7,\r\n      path: \"/\",\r\n    })\r\n\r\n    return response\r\n  }\r\n\r\n  const createdUser = await signUpUser(signupUserRequestBody)\r\n\r\n  const response = NextResponse.redirect(\r\n    new URL(\"/\", process.env.NEXT_PUBLIC_HOME_URL),\r\n  )\r\n\r\n  response.cookies.set(\"jwt\", generateJwtToken(createdUser.uuid), {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    maxAge: 60 * 60 * 24 * 7,\r\n    path: \"/\",\r\n  })\r\n\r\n  return response\r\n}\r\n","export const omit = <T extends object, K extends keyof T>(\r\n  obj: T,\r\n  keys: K[],\r\n): Omit<T, K> => {\r\n  return Object.fromEntries(\r\n    Object.entries(obj).filter(([key]) => !keys.includes(key as K)),\r\n  ) as Omit<T, K>\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[3]}