module.exports=[500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},224361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},688947,(e,t,r)=>{t.exports=e.x("stream",()=>require("stream"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},904739,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parse=function(e,t){let r=new l,a=e.length;if(a<2)return r;let n=t?.decode||d,i=0;do{let t=e.indexOf("=",i);if(-1===t)break;let s=e.indexOf(";",i),o=-1===s?a:s;if(t>o){i=e.lastIndexOf(";",t-1)+1;continue}let l=u(e,i,t),d=c(e,t,l),p=e.slice(l,d);if(void 0===r[p]){let a=u(e,t+1,o),i=c(e,o,a),s=n(e.slice(a,i));r[p]=s}i=o+1}while(i<a)return r},r.serialize=function(e,t,r){let l=r?.encode||encodeURIComponent;if(!a.test(e))throw TypeError(`argument name is invalid: ${e}`);let u=l(t);if(!n.test(u))throw TypeError(`argument val is invalid: ${t}`);let c=e+"="+u;if(!r)return c;if(void 0!==r.maxAge){if(!Number.isInteger(r.maxAge))throw TypeError(`option maxAge is invalid: ${r.maxAge}`);c+="; Max-Age="+r.maxAge}if(r.domain){if(!i.test(r.domain))throw TypeError(`option domain is invalid: ${r.domain}`);c+="; Domain="+r.domain}if(r.path){if(!s.test(r.path))throw TypeError(`option path is invalid: ${r.path}`);c+="; Path="+r.path}if(r.expires){var d;if(d=r.expires,"[object Date]"!==o.call(d)||!Number.isFinite(r.expires.valueOf()))throw TypeError(`option expires is invalid: ${r.expires}`);c+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(c+="; HttpOnly"),r.secure&&(c+="; Secure"),r.partitioned&&(c+="; Partitioned"),r.priority)switch("string"==typeof r.priority?r.priority.toLowerCase():void 0){case"low":c+="; Priority=Low";break;case"medium":c+="; Priority=Medium";break;case"high":c+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch("string"==typeof r.sameSite?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":c+="; SameSite=Strict";break;case"lax":c+="; SameSite=Lax";break;case"none":c+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${r.sameSite}`)}return c};let a=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,n=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,l=(()=>{let e=function(){};return e.prototype=Object.create(null),e})();function u(e,t,r){do{let r=e.charCodeAt(t);if(32!==r&&9!==r)return t}while(++t<r)return r}function c(e,t,r){for(;t>r;){let r=e.charCodeAt(--t);if(32!==r&&9!==r)return t+1}return r}function d(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},120635,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},29173,(e,t,r)=>{t.exports=e.x("@prisma/client",()=>require("@prisma/client"))},876096,(e,t,r)=>{t.exports=e.x("@prisma/client/scripts/default-index.js",()=>require("@prisma/client/scripts/default-index.js"))},270406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},961724,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-route-turbo.runtime.prod.js"))},63059,e=>{"use strict";e.s(["handleResponse",()=>r]);var t=e.i(89171);let r=(e,r,a,n)=>t.NextResponse.json({status:r,message:e,data:a},{status:r,headers:n})},383097,e=>{"use strict";e.s(["ApiError",()=>t,"getApiError",()=>r]);class t extends Error{status;data;constructor(e){super(e.message||"An error occurred"),this.status=e.status,this.data=e.data??void 0}}let r=e=>{if("object"==typeof e&&null!==e&&"status"in e&&"message"in e)return new t({status:Number(e.status)||500,message:e.message,data:e.data});let r=e=>new t({status:500,message:e,data:void 0}),a=e=>"object"==typeof e&&null!==e&&"data"in e;if(!a(e))return r(e instanceof Error?e.message:"Произошла неизвестная ошибка");if(!a(e.data))return r(e.data instanceof Error?e.data.message:"Произошла неизвестная ошибка");let n=e.data;return new t({status:Number(n.status)||500,message:n.error||"Ошибка запроса",data:n.data??void 0})}},282623,e=>{"use strict";e.s(["handleError",()=>a]);var t=e.i(383097),r=e.i(63059);let a=e=>{if(e instanceof t.ApiError)return(0,r.handleResponse)(e.message,e.status,e.data);if(e&&"object"==typeof e&&"issues"in e&&Array.isArray(e.issues)){let t=e.issues.map(e=>e.message);return(0,r.handleResponse)(t.join("; "),400)}let a=(0,t.getApiError)(e);return(0,r.handleResponse)(a.message,a.status,a.data)}},686929,e=>{"use strict";e.s(["prisma",()=>i],686929);var t=e.i(29173),r=e.i(876096),a="@prisma/extension-accelerate",n="Unable to connect to the Accelerate API. This may be due to a network or DNS issue. Please check your connection and the Accelerate connection string. For details, visit https://www.prisma.io/docs/accelerate/troubleshoot.";let i=new t.PrismaClient().$extends(function(e){var t;let i;return t=(void 0)??fetch,i=function(e,t){let[r=0,a=0,n=0]=e.split(".").map(Number),[i=0,s=0,o=0]=t.split(".").map(Number);return i-r||s-a||o-n}("5.1.0",r.default.Prisma.prismaVersion.client)>=0,r.default.Prisma.defineExtension(e=>{let s,o,l,{apiKeyPromise:u,baseURL:c}=function(e){let t=Reflect.get(e,"_accelerateEngineConfig");try{let{host:e,hostname:r,protocol:a,searchParams:n}=new URL(t?.accelerateUtils?.resolveDatasourceUrl?.(t));if("prisma+postgres:"===a&&("localhost"===r||"127.0.0.1"===r))return{apiKeyPromise:Promise.resolve(n.get("api_key")),baseURL:new URL(`http://${e}`)}}catch{}return{apiKeyPromise:e._engine.start().then(()=>e._engine.apiKey?.()??null),baseURL:new URL("https://accelerate.prisma-data.net")}}(e),d=(s=r.default.Prisma.prismaVersion,o=["u">typeof navigator?navigator.userAgent:"u">typeof process&&"u">typeof process.versions?`Node/${process.versions.node} (${process.platform}; ${process.arch})`:"EdgeRuntime"in globalThis?"Vercel-Edge-Runtime":"UnknownRuntime",`PrismaEngine/${s.engine}`,`PrismaClient/${s.client}`].join(" "),async e=>{let{args:r}=e,{cacheStrategy:a,__accelerateInfo:i=!1,...s}=r,u=null,{__internalParams:c,query:d}=e;return c.customDataProxyFetch=()=>async(e,r)=>{let i=[];"number"==typeof a?.ttl&&i.push(`max-age=${a.ttl}`),"number"==typeof a?.swr&&i.push(`stale-while-revalidate=${a.swr}`);let s=a?.tags?.join(",")??"";r.headers={...r.headers,"cache-control":i.length>0?i.join(","):"no-cache","user-agent":o,...s.length>0?{"accelerate-cache-tags":s}:{}},l&&(r.headers["accelerate-query-engine-jwt"]=l);try{let a=await t(e,r);return u={cacheStatus:a.headers.get("accelerate-cache-status"),lastModified:new Date(a.headers.get("last-modified")??""),region:a.headers.get("cf-ray")?.split("-")[1]??"unspecified",requestId:a.headers.get("cf-ray")??"unspecified",signature:a.headers.get("accelerate-signature")??"unspecified"},l=a.headers.get("accelerate-query-engine-jwt")??void 0,a}catch{throw Error(n)}},i?{data:await d(s,c),info:u}:d(s,c)});async function p(e){let r,a=await u;if(!a)return{requestId:"unspecified"};try{r=await t(new URL("/invalidate",c).href,{method:"POST",headers:{authorization:`Bearer ${a}`,"content-type":"application/json"},body:JSON.stringify(e)})}catch{throw Error(n)}if(!r?.ok){let e=await r.text();throw Error(`Failed to invalidate Accelerate cache. Response was ${r.status} ${r.statusText}. ${e}`)}return r.body?.cancel(),{requestId:r.headers.get("cf-ray")??"unspecified"}}let h=e.$extends({name:a,query:{$allModels:{$allOperations:d}}});return h.$extends({name:a,client:{$accelerate:{invalidate:e=>p(e),invalidateAll:()=>p({tags:"all"})}},model:{$allModels:{aggregate(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.aggregate(e),{withAccelerateInfo:()=>a.aggregate({...e,__accelerateInfo:!0})})},count(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.count(e),{withAccelerateInfo:()=>a.count({...e,__accelerateInfo:!0})})},findFirst(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.findFirst(e),{withAccelerateInfo:()=>a.findFirst({...e,__accelerateInfo:!0})})},findFirstOrThrow(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.findFirstOrThrow(e),{withAccelerateInfo:()=>a.findFirstOrThrow({...e,__accelerateInfo:!0})})},findMany(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.findMany(e),{withAccelerateInfo:()=>a.findMany({...e,__accelerateInfo:!0})})},findUnique(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.findUnique(e),{withAccelerateInfo:()=>a.findUnique({...e,__accelerateInfo:!0})})},findUniqueOrThrow(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.findUniqueOrThrow(e),{withAccelerateInfo:()=>a.findUniqueOrThrow({...e,__accelerateInfo:!0})})},groupBy(e){let t=r.default.Prisma.getExtensionContext(this),a=i?t.$parent[t.$name]:h[t.name];return Object.assign(a.groupBy(e),{withAccelerateInfo:()=>a.groupBy({...e,__accelerateInfo:!0})})}}}})})}())},501424,e=>{"use strict";e.s(["auth",()=>s,"createRoute",()=>a,"errorBoundary",()=>n,"jsonBody",()=>i,"requireRole",()=>o]);var t=e.i(282623),r=e.i(686929);let a=(e,t)=>{let r=e.reduceRight((e,t)=>t(e),t);return async(e,t)=>{let a=t?.params,n=a&&"function"==typeof a.then?await a:a,i=Object.fromEntries(new URL(e.url).searchParams.entries());return r({request:e,params:n,queryParams:i})}},n=()=>e=>async r=>{try{return await e(r)}catch(e){return(0,t.handleError)(e)}};function i(){return e=>async r=>{try{let t=await r.request.json();return e({...r,body:t})}catch{return(0,t.handleError)({status:400,message:"Invalid JSON body"})}}}let s=()=>r=>async a=>{let n=a.request.headers.get("cookie")||"",{parse:i}=await e.A(696569),s=await e.A(119764),o=i(n).jwt;if(!o)return(0,t.handleError)({status:401,message:"Не авторизован"});try{let e=s.default.verify(o,process.env.JWT_SECRET);return r({...a,userUuid:e})}catch{return(0,t.handleError)({status:401,message:"Неверный токен"})}},o=e=>a=>async n=>{let i=Array.isArray(e)?e:[e],s=await r.prisma.user.findFirst({where:{uuid:n.userUuid}});return s?i.includes(s.role)?a(n):(0,t.handleError)({status:403,message:"Нет доступа"}):(0,t.handleError)({status:401,message:"Не авторизован"})}},851622,e=>{"use strict";e.s(["deleteJwtCookie",()=>i,"generateJwtCookie",()=>n,"generateJwtToken",()=>a]);var t=e.i(724652),r=e.i(904739);let a=e=>t.default.sign(e,process.env.JWT_SECRET),n=e=>(0,r.serialize)("jwt",a(e),{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:604800}),i=()=>(0,r.serialize)("jwt","",{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:0})},496459,(e,t,r)=>{},457917,e=>{"use strict";e.s(["handler",()=>$,"patchFetch",()=>P,"routeModule",()=>R,"serverHooks",()=>C,"workAsyncStorage",()=>b,"workUnitAsyncStorage",()=>A],457917);var t=e.i(747909),r=e.i(174017),a=e.i(996250),n=e.i(759756),i=e.i(561916),s=e.i(869741),o=e.i(316795),l=e.i(487718),u=e.i(995169),c=e.i(47587),d=e.i(666012),p=e.i(570101),h=e.i(626937),f=e.i(10372),m=e.i(193695);e.i(52474);var g=e.i(600220);e.s(["POST",()=>v],738279);var x=e.i(63059),y=e.i(851622),w=e.i(501424);let v=(0,w.createRoute)([(0,w.errorBoundary)()],async()=>(0,x.handleResponse)("Пользователь успешно вышел из системы",200,null,{"Content-Type":"application/json","Set-Cookie":(0,y.deleteJwtCookie)()}));var E=e.i(738279);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/user/sign-out/route",pathname:"/api/user/sign-out",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/user/sign-out/route.ts",nextConfigOutput:"",userland:E}),{workAsyncStorage:b,workUnitAsyncStorage:A,serverHooks:C}=R;function P(){return(0,a.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:A})}async function $(e,t,a){var x;let y="/api/user/sign-out/route";y=y.replace(/\/index$/,"")||"/";let w=await R.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:E,nextConfig:b,isDraftMode:A,prerenderManifest:C,routerServerContext:P,isOnDemandRevalidate:$,revalidateOnlyGenerated:j,resolvedPathname:O}=w,T=(0,s.normalizeAppPath)(y),_=!!(C.dynamicRoutes[T]||C.routes[O]);if(_&&!A){let e=!!C.routes[O],t=C.dynamicRoutes[T];if(t&&!1===t.fallback&&!e)throw new m.NoFallbackError}let S=null;!_||R.isDev||A||(S="/index"===(S=O)?"/":S);let q=!0===R.isDev||!_,I=_&&!q,k=e.method||"GET",U=(0,i.getTracer)(),N=U.getActiveScopeSpan(),M={params:E,prerenderManifest:C,renderOpts:{experimental:{cacheComponents:!!b.experimental.cacheComponents,authInterrupts:!!b.experimental.authInterrupts},supportsDynamicResponse:q,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(x=b.experimental)?void 0:x.cacheLife,isRevalidate:I,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>R.onRequestError(e,t,a,P)},sharedContext:{buildId:v}},D=new o.NodeNextRequest(e),F=new o.NodeNextResponse(t),H=l.NextRequestAdapter.fromNodeNextRequest(D,(0,l.signalFromNodeResponse)(t));try{let s=async r=>R.handle(H,M).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=U.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=a.get("next.route");if(n){let e=`${k} ${n}`;r.setAttributes({"next.route":n,"http.route":n,"next.span_name":e}),r.updateName(e)}else r.updateName(`${k} ${e.url}`)}),o=async i=>{var o,l;let u=async({previousCacheEntry:r})=>{try{if(!(0,n.getRequestMeta)(e,"minimalMode")&&$&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(i);e.fetchMetrics=M.renderOpts.fetchMetrics;let l=M.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=M.renderOpts.collectedTags;if(!_)return await (0,d.sendResponse)(D,F,o,M.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,p.toNodeOutgoingHttpHeaders)(o.headers);u&&(t[f.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,a=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:I,isOnDemandRevalidate:$})},P),t}},m=await R.handleResponse({req:e,nextConfig:b,cacheKey:S,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:$,revalidateOnlyGenerated:j,responseGenerator:u,waitUntil:a.waitUntil});if(!_)return null;if((null==m||null==(o=m.value)?void 0:o.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(l=m.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,n.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",$?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let x=(0,p.fromNodeOutgoingHttpHeaders)(m.value.headers);return(0,n.getRequestMeta)(e,"minimalMode")&&_||x.delete(f.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||t.getHeader("Cache-Control")||x.get("Cache-Control")||x.set("Cache-Control",(0,h.getCacheControlHeader)(m.cacheControl)),await (0,d.sendResponse)(D,F,new Response(m.value.body,{headers:x,status:m.value.status||200})),null};N?await o(N):await U.withPropagatedContext(e.headers,()=>U.trace(u.BaseServerSpan.handleRequest,{spanName:`${k} ${e.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":k,"http.target":e.url}},o))}catch(t){if(N||t instanceof m.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:T,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isRevalidate:I,isOnDemandRevalidate:$})}),_)throw t;return await (0,d.sendResponse)(D,F,new Response(null,{status:500})),null}}},696569,e=>{e.v(e=>Promise.resolve().then(()=>e(904739)))},119764,e=>{e.v(e=>Promise.resolve().then(()=>e(724652)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__598bd541._.js.map